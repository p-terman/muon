#include <cstdlib>
#include <ctime> 
#include <vector>
#include <iostream>
#include <cmath>
#define PI 3.14159265358979323846
/**********************************************************
* This function includes the digitized data set from the surface lab noise study PDF. 
* The data points correspond to plot B5 (Preamp + Postamp to STRUCK).
* callMyFunction.cc provides an example of how one would use this function to generate noise at some given time based on the
* noise spectrum from plot B5.
***********************************************************/

using namespace std;

double unifRand()
{
    	return (2*PI)*(rand() / double(RAND_MAX));
}

vector <double> randNoiseGeneratorNoRoot(double time_input){

	srand(time(NULL));
	double binCenter[] = {1060.07,1071.59,1083.23,1095,1106.9,1118.92,1131.08,1143.37,1155.79,1168.35,1181.05,1193.88,1206.85,1219.96,1233.22,1246.62,1260.17,1273.86,1287.7,1301.69,1315.83,1330.13,1344.58,1359.19,1373.96,1388.89,1403.98,1419.24,1434.66,1450.24,1466,1481.93,1498.03,1514.31,1530.76,1547.4,1564.21,1581.2,1598.38,1615.75,1633.31,1651.05,1668.99,1687.13,1705.46,1723.99,1742.72,1761.66,1780.8,1800.15,1819.71,1839.48,1859.47,1879.67,1900.09,1920.74,1941.61,1962.71,1984.03,2005.59,2027.38,2049.41,2071.68,2094.19,2116.94,2139.94,2163.19,2186.7,2210.46,2234.47,2258.75,2283.3,2308.1,2333.18,2358.53,2384.16,2410.07,2436.25,2462.72,2489.48,2516.53,2543.87,2571.52,2599.46,2627.7,2656.25,2685.11,2714.29,2743.78,2773.59,2803.73,2834.19,2864.99,2896.12,2927.58,2959.39,2991.55,3024.05,3056.91,3090.13,3123.7,3157.64,3191.95,3226.63,3261.69,3297.13,3332.96,3369.17,3405.78,3442.78,3480.19,3518.01,3556.23,3594.87,3633.93,3673.41,3713.33,3753.67,3794.46,3835.69,3877.37,3919.49,3962.08,4005.13,4048.65,4092.64,4137.11,4182.06,4227.5,4273.43,4319.87,4366.8,4414.25,4462.21,4510.7,4559.71,4609.25,4659.33,4709.96,4761.14,4812.87,4865.16,4918.02,4971.46,5025.48,5080.08,5135.28,5191.08,5247.48,5304.5,5362.13,5420.39,5479.29,5538.82,5599.01,5659.84,5721.34,5783.5,5846.34,5909.87,5974.08,6038.99,6104.61,6170.94,6237.99,6305.77,6374.28,6443.54,6513.55,6584.32,6655.87,6728.19,6801.29,6875.19,6949.89,7025.41,7101.74,7178.9,7256.91,7335.76,7415.46,7496.03,7577.48,7659.81,7743.04,7827.17,7912.22,7998.19,8085.09,8172.94,8261.74,8351.51,8442.26,8533.98,8626.71,8720.44,8815.2,8910.98,9007.8,9105.67,9204.61,9304.62,9405.72,9507.92,9611.23,9715.66,9821.22,9927.93,10035.8,10144.8,10255.1,10366.5,10479.1,10593,10708.1,10824.4,10942.1,11061,11181.1,11302.6,11425.4,11549.6,11675.1,11801.9,11930.2,12059.8,12190.8,12323.3,12457.2,12592.5,12729.3,12867.7,13007.5,13148.8,13291.7,13436.1,13582.1,13729.7,13878.8,14029.6,14182.1,14336.2,14491.9,14649.4,14808.6,14969.5,15132.1,15296.5,15462.7,15630.8,15800.6,15972.3,16145.8,16321.2,16498.6,16677.8,16859.1,17042.2,17227.4,17414.6,17603.8,17795.1,17988.4,18183.9,18381.5,18581.2,18783.1,18987.2,19193.5,19402,19612.8,19825.9,20041.4,20259.1,20479.2,20701.8,20926.7,21154.1,21383.9,21616.3,21851.1,22088.6,22328.6,22571.2,22816.4,23064.3,23314.9,23568.3,23824.3,24083.2,24344.9,24609.4,24876.8,25147.1,25420.3,25696.5,25975.7,26258,26543.3,26831.7,27123.2,27417.9,27715.8,28017,28321.4,28629.1,28940.2,29254.6,29572.5,29893.8,30218.6,30547,30878.9,31214.4,31553.5,31896.4,32243,32593.3,32947.4,33305.4,33667.3,34033.1,34402.9,34776.7,35154.6,35536.5,35922.7,36313,36707.5,37106.4,37509.6,37917.1,38329.1,38745.6,39166.6,39592.1,40022.3,40457.2,40896.8,41341.1,41790.3,42244.4,42703.4,43167.4,43636.4,44110.5,44589.8,45074.3,45564.1,46059.1,46559.6,47065.5,47576.9,48093.8,48616.4,49144.6,49678.6,50218.4,50764,51315.6,51873.2,52436.8,53006.5,53582.5,54164.7,54753.2,55348.1,55949.5,56557.4,57171.9,57793.1,58421.1,59055.9,59697.5,60346.2,61001.9,61664.7,62334.7,63012,63696.6,64388.7,65088.3,65795.6,66510.5,67233.1,67963.6,68702.1,69448.6,70203.2,70966,71737,72516.5,73304.4,74100.9,74906,75719.9,76542.7,77374.3,78215,79064.9,79924,80792.4,81670.2,82557.6,83454.6,84361.4,85278,86204.6,87141.3,88088.1,89045.2,90012.7,90990.8,91979.4,92978.8,93989.1,95010.3,96042.6,97086.2,98141.1,99207.4,100285,101375,102476,103590,104715,105853,107003,108166,109341,110529,111730,112944,114172,115412,116666,117934,119215,120510,121820,123143,124481,125834,127201,128583,129980,131393,132820,134264,135722,137197,138688,140195,141718,143258,144814,146388,147978,149586,151212,152855,154515,156194,157891,159607,161341,163094,164866,166658,168469,170299,172149,174020,175911,177822,179754,181707,183682,185677,187695,189734,191796,193880,195986,198116,200268,202444,204644,206868,209115,211387,213684,216006,218353,220726,223124,225548,227999,230476,232980,235512,238071,240658,243272,245916,248588,251289,254019,256779,259569,262389,265240,268122,271036,273981,276958,279967,283009,286084,289192,292334,295511,298722,301967,305248,308565,311918,315307,318733,322196,325697,329236,332813,336429,340085,343780,347515,351291,355108,358966,362867,366809,370795,374824,378897,383013,387175,391382,395634,399933,404279,408671,413112,417600,422138,426724,431361,436048,440786,445575,450417,455311,460258,465259,470314,475424,480590,485812,491090,496426,501820,507272,512784,518356,523988,529681,535437,541254,547135,553080,559090,565164,571305,577513,583788,590131,596543,603025,609577,616200,622895,629663,636505,643421,650412,657479,664623,671844,679144,686523,693983,701523,709146,716851,724640,732513,740472,748518,756651,764872,773183,781584,790076,798661,807339,816111,824978,833942,843003,852163,861422,870781,880243,889807,899475,909249,919128,929115,939210,949415,959731,970159,980700,991356,1.00213e+06,1.01302e+06,1.02402e+06,1.03515e+06,1.0464e+06,1.05777e+06,1.06926e+06,1.08088e+06,1.09262e+06,1.10449e+06,1.11649e+06,1.12863e+06,1.14089e+06,1.15328e+06,1.16582e+06,1.17848e+06,1.19129e+06,1.20423e+06,1.21732e+06,1.23054e+06,1.24391e+06,1.25743e+06,1.27109e+06,1.2849e+06,1.29886e+06,1.31298e+06,1.32724e+06,1.34166e+06,1.35624e+06,1.37098e+06,1.38587e+06,1.40093e+06,1.41615e+06,1.43154e+06,1.44709e+06,1.46282e+06,1.47871e+06,1.49478e+06,1.51102e+06,1.52744e+06,1.54404e+06,1.56081e+06,1.57777e+06,1.59491e+06,1.61224e+06,1.62976e+06,1.64747e+06,1.66537e+06,1.68346e+06,1.70176e+06,1.72025e+06,1.73894e+06,1.75783e+06,1.77693e+06,1.79624e+06,1.81576e+06,1.83549e+06,1.85543e+06,1.87559e+06,1.89597e+06,1.91657e+06,1.93739e+06,1.95844e+06,1.97972e+06,2.00123e+06,2.02298e+06,2.04496e+06,2.06718e+06,2.08964e+06,2.11234e+06,2.1353e+06,2.1585e+06,2.18195e+06,2.20566e+06,2.22962e+06,2.25385e+06,2.27834e+06,2.30309e+06,2.32812e+06,2.35341e+06,2.37898e+06,2.40483e+06,2.43096e+06,2.45738e+06,2.48408e+06,2.51107e+06,2.53835e+06,2.56593e+06,2.59381e+06,2.62199e+06,2.65048e+06,2.67928e+06,2.70839e+06,2.73782e+06,2.76757e+06,2.79764e+06,2.82804e+06,2.85877e+06,2.88983e+06,2.92123e+06,2.95297e+06,2.98505e+06,3.01749e+06,3.05027e+06,3.08342e+06,3.11692e+06,3.15079e+06,3.18502e+06,3.21963e+06,3.25461e+06,3.28997e+06,3.32572e+06,3.36185e+06,3.39838e+06,3.43531e+06,3.47263e+06,3.51037e+06,3.54851e+06,3.58706e+06,3.62604e+06,3.66544e+06,3.70526e+06,3.74552e+06,3.78622e+06,3.82736e+06,3.86895e+06,3.91098e+06,3.95348e+06,3.99643e+06,4.03986e+06,4.08375e+06,4.12812e+06,4.17298e+06,4.21832e+06,4.26415e+06,4.31049e+06,4.35732e+06,4.40467e+06,4.45252e+06,4.5009e+06,4.54981e+06,4.59924e+06,4.64922e+06,4.69973e+06,4.7508e+06,4.80242e+06,4.8546e+06,4.90734e+06,4.96066e+06,5.01456e+06,5.06905e+06,5.12413e+06,5.1798e+06,5.23608e+06,5.29298e+06,5.35049e+06,5.40862e+06,5.46739e+06,5.5268e+06,5.58685e+06,5.64755e+06,5.70891e+06,5.77094e+06,5.83365e+06,5.89703e+06,5.96111e+06,6.02588e+06,6.09135e+06,6.15754e+06,6.22444e+06,6.29207e+06,6.36044e+06,6.42955e+06,6.49941e+06,6.57003e+06,6.64141e+06,6.71358e+06,6.78652e+06,6.86026e+06,6.9348e+06,7.01015e+06,7.08632e+06,7.16332e+06,7.24115e+06,7.31983e+06,7.39936e+06,7.47976e+06,7.56103e+06,7.64318e+06,7.72623e+06,7.81018e+06,7.89504e+06,7.98082e+06,8.06754e+06,8.1552e+06,8.24381e+06,8.33338e+06,8.42392e+06,8.51545e+06,8.60798e+06,8.70151e+06,8.79605e+06,8.89163e+06,8.98824e+06,9.0859e+06,9.18462e+06,9.28442e+06,9.3853e+06,9.48727e+06,9.59036e+06,9.69456e+06,9.7999e+06,9.90638e+06,1.0014e+07,1.01228e+07,1.02328e+07,1.0344e+07,1.04564e+07,1.057e+07,1.06848e+07,1.08009e+07,1.09183e+07,1.10369e+07,1.11569e+07,1.12781e+07,1.14006e+07,1.15245e+07,1.16497e+07,1.17763e+07,1.19042e+07,1.20336e+07,1.21643e+07,1.22965e+07,1.24301e+07,1.25652e+07,1.27017e+07,1.28397e+07,1.29792e+07,1.31203e+07,1.32628e+07,1.34069e+07,1.35526e+07,1.36998e+07,1.38487e+07,1.39992e+07,1.41513e+07,1.4305e+07,1.44605e+07,1.46176e+07,1.47764e+07,1.4937e+07,1.50993e+07,1.52633e+07,1.54292e+07,1.55968e+07,1.57663e+07,1.59376e+07,1.61108e+07,1.62858e+07,1.64628e+07,1.66416e+07,1.68225e+07,1.70052e+07,1.719e+07,1.73768e+07,1.75656e+07,1.77565e+07,1.79494e+07,1.81444e+07,1.83416e+07,1.85408e+07,1.87423e+07,1.89459e+07,1.91518e+07,1.93599e+07,1.95702e+07,1.97829e+07,1.99978e+07,2.02151e+07,2.04348e+07,2.06568e+07,2.08813e+07,2.11081e+07,2.13375e+07,2.15693e+07,2.18037e+07,2.20406e+07,2.22801e+07,2.25222e+07,2.27669e+07,2.30142e+07,2.32643e+07,2.35171e+07,2.37726e+07,2.40309e+07,2.4292e+07,2.4556e+07,2.48228e+07,2.50925e+07,2.53651e+07,2.56407e+07,2.59193e+07,2.6201e+07,2.64856e+07,2.67734e+07,2.70643e+07,2.73584e+07,2.76556e+07,2.79561e+07,2.82599e+07,2.8567e+07,2.88773e+07,2.91911e+07,2.95083e+07,2.98289e+07,3.0153e+07,3.04806e+07,3.08118e+07,3.11466e+07,3.1485e+07,3.18271e+07,3.21729e+07,3.25225e+07,3.28759e+07,3.32331e+07,3.35942e+07,3.39592e+07,3.43282e+07,3.47012e+07,3.50782e+07,3.54594e+07,3.58447e+07,3.62341e+07,3.66278e+07,3.70258e+07,3.74281e+07,3.78348e+07,3.82459e+07,3.86614e+07,3.90815e+07,3.95061e+07,3.99354e+07,4.03693e+07,4.08079e+07,4.12513e+07,4.16996e+07,4.21526e+07,4.26107e+07,4.30736e+07,4.35417e+07,4.40148e+07,4.4493e+07,4.49764e+07,4.54651e+07,4.59591e+07,4.64585e+07,4.69633e+07,4.74736e+07,4.79894e+07,4.85108e+07,4.90379e+07,4.95707e+07,5.01093e+07,5.06538e+07,5.12042e+07,0};
	double binWidth[] = {11.4559,11.5804,11.7062,11.8334,11.962,12.0919,12.2233,12.3561,12.4904,12.6261,12.7633,12.902,13.0421,13.1839,13.3271,13.4719,13.6183,13.7663,13.9158,14.067,14.2199,14.3744,14.5306,14.6885,14.8481,15.0094,15.1725,15.3373,15.504,15.6724,15.8427,16.0149,16.1889,16.3648,16.5426,16.7223,16.904,17.0877,17.2733,17.461,17.6508,17.8425,18.0364,18.2324,18.4305,18.6307,18.8332,19.0378,19.2447,19.4538,19.6651,19.8788,20.0948,20.3131,20.5338,20.757,20.9825,21.2105,21.4409,21.6739,21.9094,22.1474,22.3881,22.6313,22.8772,23.1258,23.3771,23.6311,23.8879,24.1474,24.4098,24.675,24.9431,25.2141,25.4881,25.765,26.045,26.328,26.614,26.9032,27.1955,27.491,27.7897,28.0917,28.3969,28.7054,29.0173,29.3326,29.6513,29.9735,30.2992,30.6284,30.9612,31.2976,31.6377,31.9814,32.3289,32.6802,33.0353,33.3942,33.7571,34.1239,34.4946,34.8694,35.2483,35.6313,36.0184,36.4098,36.8054,37.2053,37.6096,38.0182,38.4313,38.8489,39.271,39.6977,40.129,40.565,41.0058,41.4513,41.9017,42.357,42.8172,43.2825,43.7527,44.2281,44.7087,45.1945,45.6855,46.1819,46.6837,47.191,47.7037,48.222,48.746,49.2756,49.811,50.3523,50.8994,51.4524,52.0115,52.5766,53.1479,53.7253,54.3091,54.8992,55.4957,56.0987,56.7082,57.3244,57.9472,58.5768,59.2133,59.8567,60.5071,61.1645,61.8291,62.5009,63.18,63.8665,64.5604,65.2619,65.971,66.6878,67.4124,68.1448,68.8853,69.6337,70.3903,71.1552,71.9283,72.7098,73.4999,74.2985,75.1058,75.9218,76.7467,77.5806,78.4236,79.2757,80.1371,81.0078,81.888,82.7777,83.6771,84.5863,85.5054,86.4344,87.3736,88.323,89.2826,90.2527,91.2334,92.2247,93.2267,94.2397,95.2636,96.2987,97.345,98.4027,99.4719,100.553,101.645,102.75,103.866,104.995,106.136,107.289,108.454,109.633,110.824,112.028,113.245,114.476,115.72,116.977,118.248,119.533,120.832,122.145,123.472,124.813,126.17,127.54,128.926,130.327,131.743,133.175,134.622,136.084,137.563,139.058,140.568,142.096,143.64,145.2,146.778,148.373,149.985,151.615,153.262,154.927,156.611,158.312,160.033,161.771,163.529,165.306,167.102,168.918,170.753,172.608,174.484,176.38,178.296,180.233,182.192,184.171,186.172,188.195,190.24,192.307,194.397,196.509,198.644,200.802,202.984,205.19,207.419,209.673,211.951,214.254,216.582,218.935,221.314,223.719,226.15,228.607,231.091,233.602,236.14,238.706,241.299,243.921,246.571,249.25,251.959,254.696,257.464,260.261,263.089,265.948,268.837,271.758,274.711,277.696,280.713,283.763,286.847,289.963,293.114,296.299,299.518,302.773,306.062,309.388,312.749,316.148,319.583,323.055,326.565,330.114,333.7,337.326,340.991,344.696,348.442,352.228,356.055,359.923,363.834,367.787,371.784,375.823,379.907,384.035,388.207,392.425,396.689,400.999,405.356,409.761,414.213,418.714,423.263,427.862,432.511,437.211,441.961,446.763,451.617,456.524,461.485,466.499,471.568,476.692,481.871,487.107,492.399,497.75,503.158,508.625,514.151,519.738,525.385,531.094,536.864,542.697,548.594,554.555,560.58,566.671,572.828,579.052,585.344,591.704,598.133,604.632,611.202,617.843,624.556,631.342,638.202,645.136,652.146,659.232,666.395,673.635,680.955,688.354,695.833,703.394,711.036,718.762,726.572,734.466,742.447,750.514,758.668,766.911,775.244,783.668,792.183,800.79,809.491,818.287,827.178,836.165,845.251,854.435,863.718,873.103,882.59,892.18,901.873,911.673,921.578,931.592,941.714,951.946,962.29,972.745,983.315,993.999,1004.8,1015.72,1026.75,1037.91,1049.19,1060.59,1072.11,1083.76,1095.53,1107.44,1119.47,1131.63,1143.93,1156.36,1168.92,1181.62,1194.46,1207.44,1220.56,1233.82,1247.23,1260.78,1274.48,1288.33,1302.33,1316.48,1330.78,1345.24,1359.86,1374.63,1389.57,1404.67,1419.93,1435.36,1450.95,1466.72,1482.65,1498.76,1515.05,1531.51,1548.15,1564.97,1581.98,1599.17,1616.54,1634.11,1651.86,1669.81,1687.95,1706.29,1724.83,1743.57,1762.52,1781.67,1801.03,1820.6,1840.38,1860.38,1880.59,1901.02,1921.68,1942.56,1963.67,1985,2006.57,2028.37,2050.41,2072.69,2095.21,2117.98,2140.99,2164.25,2187.77,2211.54,2235.57,2259.86,2284.41,2309.23,2334.32,2359.69,2385.33,2411.24,2437.44,2463.93,2490.7,2517.76,2545.12,2572.77,2600.73,2628.98,2657.55,2686.43,2715.61,2745.12,2774.95,2805.1,2835.58,2866.39,2897.53,2929.02,2960.84,2993.01,3025.53,3058.41,3091.64,3125.23,3159.19,3193.51,3228.21,3263.29,3298.74,3334.59,3370.82,3407.44,3444.47,3481.89,3519.73,3557.97,3596.63,3635.71,3675.21,3715.14,3755.51,3796.32,3837.56,3879.26,3921.41,3964.02,4007.09,4050.63,4094.64,4139.13,4184.1,4229.57,4275.52,4321.98,4368.94,4416.41,4464.4,4512.9,4561.94,4611.51,4661.61,4712.26,4763.46,4815.22,4867.54,4920.43,4973.89,5027.93,5082.56,5137.79,5193.61,5250.04,5307.09,5364.75,5423.04,5481.97,5541.53,5601.74,5662.61,5724.14,5786.33,5849.2,5912.76,5977,6041.94,6107.59,6173.95,6241.04,6308.85,6377.4,6446.69,6516.74,6587.54,6659.12,6731.48,6804.62,6878.55,6953.29,7028.84,7105.21,7182.41,7260.45,7339.34,7419.09,7499.7,7581.19,7663.56,7746.83,7831,7916.09,8002.1,8089.05,8176.94,8265.78,8355.6,8446.38,8538.16,8630.93,8724.71,8819.5,8915.33,9012.2,9110.12,9209.11,9309.17,9410.32,9512.57,9615.93,9720.41,9826.02,9932.79,10040.7,10149.8,10260.1,10371.6,10484.3,10598.2,10713.3,10829.7,10947.4,11066.4,11186.6,11308.1,11431,11555.2,11680.8,11807.7,11936,12065.7,12196.8,12329.3,12463.3,12598.7,12735.6,12873.9,13013.8,13155.2,13298.2,13442.7,13588.7,13736.4,13885.6,14036.5,14189,14343.2,14499,14656.6,14815.8,14976.8,15139.5,15304,15470.3,15638.4,15808.3,15980.1,16153.7,16329.2,16506.7,16686,16867.3,17050.6,17235.8,17423.1,17612.4,17803.8,17997.2,18192.8,18390.5,18590.3,18792.3,18996.5,19202.9,19411.5,19622.4,19835.6,20051.2,20269,20489.3,20711.9,20936.9,21164.4,21394.4,21626.8,21861.8,22099.4,22339.5,22582.2,22827.6,23075.6,23326.3,23579.8,23836,24095,24356.8,24621.4,24889,25159.4,25432.7,25709.1,25988.4,26270.8,26556.3,26844.8,27136.5,27431.3,27729.4,28030.7,28335.2,28643.1,28954.3,29268.9,29587,29908.4,30233.4,30561.9,30894,31229.7,31569,31912,32258.7,32609.2,32963.5,33321.7,33683.8,34049.8,34419.7,34793.7,35171.8,35553.9,35940.2,36330.7,36725.5,37124.5,37527.9,37935.7,38347.8,38764.5,39185.7,39611.5,40041.9,40476.9,40916.7,41361.3,41810.7,42265,42724.3,43188.5,43657.7,44132.1,44611.6,45096.3,45586.3,46081.7,46582.3,47088.5,47600.1,48117.3,48640.1,49168.6,49702.9,50242.9,50788.8,51340.7,51898.5,52462.4,53032.4,53608.7,54191.2,54780,55375.2,55976.9,56585.1,57199.9,57821.4,58449.6,59084.7,59726.7,60375.7,61031.7,61694.8,62365.2,63042.8,63727.8,64420.2,65120.2,65827.7,66543,67266,67996.9,68735.7,69482.5,70237.5,71000.7,71772.1,72551.9,73340.3,74137.1,74942.7,75757,76580.1,77412.2,78253.3,79103.5,79963,80831.9,81710.2,82598,83495.4,84402.7,85319.7,86246.8,87183.9,88131.2,89088.8,90056.7,91035.3,92024.4,93024.3,94035,95056.8,96089.6,97133.7,98189.1,99255.9,100334,101425,102527,103641,104767,105905,107056,108219,109395,110583,111785,113000,114227,115468,116723,117991,119273,120569,121879,123204,124542,125896,127263,128646,130044,131457,132885,134329,135789,137264,138756,140263,141787,143328,144885,146459,148051,149659,151286,152929,154591,156271,157969,159685,161420,163174,164947,166739,168551,170382,172234,174105,175997,177909,179842,181796,183771,185768,187787,189827,191890,193975,196082,198213,200366,202543,204744,206969,209218,211491,213789,216112,218460,220834,223233,225658,228110,230589,233094,235627,238187,240775,243391,246036,248709,251412,254143,256905,259696,262518,265370,268254,271168,274115,277093,280104,283147,286224,289334,292477,295655,298868,302115,305398,308716,312070,315461,318889,322354,325856,329397,332976,336594,340251,343948,347685,351463,355282,359142,363044,366989,370976,375007,379082,383201,387364,391573,395828,400129,404476,408871,413314,417805,422344,426933,431572,436261,441001,445793,450637,455533,460483,465486,470544,475656,480825,486049,491330,496669,502065,507520,513035,518609,524244,529940,535698,541519,547403,553351,0};
	double binHeight[] = {2.26902e-06,2.24319e-06,2.21708e-06,2.19068e-06,2.164e-06,2.13702e-06,2.11221e-06,2.0899e-06,2.06735e-06,2.04455e-06,2.0215e-06,1.99821e-06,1.97497e-06,1.95215e-06,1.92908e-06,1.90577e-06,1.8822e-06,1.85837e-06,1.83429e-06,1.81192e-06,1.79253e-06,1.77294e-06,1.75313e-06,1.73311e-06,1.71287e-06,1.69241e-06,1.67074e-06,1.64865e-06,1.62632e-06,1.60374e-06,1.58092e-06,1.55785e-06,1.53923e-06,1.52266e-06,1.50591e-06,1.48897e-06,1.47186e-06,1.45455e-06,1.43762e-06,1.42411e-06,1.41046e-06,1.39666e-06,1.38271e-06,1.36861e-06,1.3532e-06,1.33552e-06,1.31766e-06,1.2996e-06,1.28135e-06,1.2629e-06,1.24424e-06,1.2302e-06,1.21711e-06,1.20388e-06,1.1905e-06,1.17698e-06,1.16331e-06,1.14947e-06,1.13546e-06,1.12131e-06,1.107e-06,1.09253e-06,1.08006e-06,1.07344e-06,1.06674e-06,1.05998e-06,1.05314e-06,1.04622e-06,1.03826e-06,1.03007e-06,1.0218e-06,1.01343e-06,1.00497e-06,9.96426e-07,9.87785e-07,9.80686e-07,9.73603e-07,9.66442e-07,9.59204e-07,9.51887e-07,9.44877e-07,9.38101e-07,9.3125e-07,9.24325e-07,9.17325e-07,9.10439e-07,9.04425e-07,8.98345e-07,8.92199e-07,8.85986e-07,8.79639e-07,8.72877e-07,8.66042e-07,8.59132e-07,8.52148e-07,8.4534e-07,8.39802e-07,8.34204e-07,8.28545e-07,8.22825e-07,8.13554e-07,8.03895e-07,7.94132e-07,7.84262e-07,7.75166e-07,7.66368e-07,7.57475e-07,7.48485e-07,7.39397e-07,7.30211e-07,7.22569e-07,7.14997e-07,7.07343e-07,6.99606e-07,6.91784e-07,6.83976e-07,6.76681e-07,6.69307e-07,6.61853e-07,6.54319e-07,6.45239e-07,6.34711e-07,6.24069e-07,6.16379e-07,6.12499e-07,6.08578e-07,6.00406e-07,5.90713e-07,5.80916e-07,5.71011e-07,5.61e-07,5.51309e-07,5.4229e-07,5.33173e-07,5.23957e-07,5.14641e-07,5.05224e-07,4.95704e-07,4.86081e-07,4.76353e-07,4.69021e-07,4.61925e-07,4.54752e-07,4.47501e-07,4.40171e-07,4.32761e-07,4.25271e-07,4.18268e-07,4.13634e-07,4.0895e-07,4.04215e-07,3.99428e-07,3.9459e-07,3.8997e-07,3.85369e-07,3.80718e-07,3.76017e-07,3.71264e-07,3.6646e-07,3.61603e-07,3.56815e-07,3.53064e-07,3.49272e-07,3.45439e-07,3.41564e-07,3.37647e-07,3.33687e-07,3.29685e-07,3.25639e-07,3.21838e-07,3.18166e-07,3.14454e-07,3.10701e-07,3.06908e-07,3.03073e-07,2.99197e-07,2.95279e-07,2.91318e-07,2.87314e-07,2.8371e-07,2.815e-07,2.79265e-07,2.77006e-07,2.74722e-07,2.72414e-07,2.70081e-07,2.67816e-07,2.65739e-07,2.6364e-07,2.61518e-07,2.59372e-07,2.56876e-07,2.54096e-07,2.51284e-07,2.48443e-07,2.45713e-07,2.43127e-07,2.40512e-07,2.37869e-07,2.35198e-07,2.32679e-07,2.30265e-07,2.27826e-07,2.2536e-07,2.22867e-07,2.20347e-07,2.17799e-07,2.1535e-07,2.12944e-07,2.10511e-07,2.08051e-07,2.05565e-07,2.03052e-07,2.00374e-07,1.97522e-07,1.94639e-07,1.91724e-07,1.88778e-07,1.86669e-07,1.84667e-07,1.82671e-07,1.81191e-07,1.79696e-07,1.78184e-07,1.76656e-07,1.75111e-07,1.73689e-07,1.72325e-07,1.70946e-07,1.69553e-07,1.68144e-07,1.66719e-07,1.6528e-07,1.63878e-07,1.6248e-07,1.61068e-07,1.5964e-07,1.57783e-07,1.55183e-07,1.52555e-07,1.49899e-07,1.47213e-07,1.45586e-07,1.44313e-07,1.43027e-07,1.41726e-07,1.4036e-07,1.38973e-07,1.37572e-07,1.36155e-07,1.34712e-07,1.32715e-07,1.30696e-07,1.28656e-07,1.26593e-07,1.25165e-07,1.24709e-07,1.24248e-07,1.23783e-07,1.23087e-07,1.21841e-07,1.20582e-07,1.19309e-07,1.18022e-07,1.16722e-07,1.16137e-07,1.15624e-07,1.15105e-07,1.14581e-07,1.14051e-07,1.13515e-07,1.12673e-07,1.10823e-07,1.08953e-07,1.07063e-07,1.05153e-07,1.04244e-07,1.03975e-07,1.03704e-07,1.03429e-07,1.02697e-07,1.00582e-07,9.84433e-08,9.62819e-08,9.40969e-08,9.37056e-08,9.35438e-08,9.33802e-08,9.32148e-08,9.24465e-08,9.11209e-08,8.97809e-08,8.84263e-08,8.74722e-08,8.70902e-08,8.67041e-08,8.63138e-08,8.59193e-08,8.55204e-08,8.45749e-08,8.31052e-08,8.16196e-08,8.01178e-08,7.96205e-08,7.92046e-08,7.87841e-08,7.83591e-08,7.71963e-08,7.54394e-08,7.36635e-08,7.18683e-08,7.21745e-08,7.33578e-08,7.4554e-08,7.40384e-08,7.24983e-08,7.09414e-08,6.93676e-08,6.77767e-08,6.74967e-08,6.76505e-08,6.78059e-08,6.78452e-08,6.77196e-08,6.73225e-08,6.64467e-08,6.55291e-08,6.40365e-08,6.30625e-08,6.36259e-08,6.41954e-08,6.37695e-08,6.28898e-08,6.20006e-08,6.11017e-08,6.01931e-08,5.92746e-08,5.8346e-08,5.77054e-08,5.7962e-08,5.82214e-08,5.77837e-08,5.70139e-08,5.62359e-08,5.61258e-08,5.61258e-08,5.57521e-08,5.50667e-08,5.43738e-08,5.45599e-08,5.8036e-08,6.155e-08,6.51021e-08,6.60453e-08,6.23439e-08,5.86023e-08,5.482e-08,5.09996e-08,5.04931e-08,4.99812e-08,4.94637e-08,4.89405e-08,4.85965e-08,4.83541e-08,4.81091e-08,4.72882e-08,4.60023e-08,4.58443e-08,4.60436e-08,4.62451e-08,4.64488e-08,4.62696e-08,4.55048e-08,4.49698e-08,4.48817e-08,4.47927e-08,4.47027e-08,4.46118e-08,4.45198e-08,4.3979e-08,4.32392e-08,4.24913e-08,4.17352e-08,4.16482e-08,4.29011e-08,4.25661e-08,4.18172e-08,4.10603e-08,4.04334e-08,4.03423e-08,4.02503e-08,4.01573e-08,3.86412e-08,3.85856e-08,3.96601e-08,3.90124e-08,3.83576e-08,3.76957e-08,3.70266e-08,3.71891e-08,3.84943e-08,3.85885e-08,3.85241e-08,3.8459e-08,3.83931e-08,3.83266e-08,3.82594e-08,3.7988e-08,3.69563e-08,3.59134e-08,3.50696e-08,3.55967e-08,3.61295e-08,3.66681e-08,4.4791e-08,5.49474e-08,6.52141e-08,6.49196e-08,5.2039e-08,3.90185e-08,3.77272e-08,3.78388e-08,3.79517e-08,3.8523e-08,4.91385e-08,5.38794e-08,4.03428e-08,3.59533e-08,3.53725e-08,3.40088e-08,3.39808e-08,3.47446e-08,3.51889e-08,3.49334e-08,3.46752e-08,3.44142e-08,3.40132e-08,3.35557e-08,3.30932e-08,3.28183e-08,3.2845e-08,3.2872e-08,3.28992e-08,3.29268e-08,3.11251e-08,3.12122e-08,3.21552e-08,3.31084e-08,3.22227e-08,3.11661e-08,3.16234e-08,3.30643e-08,3.52157e-08,3.90156e-08,3.73133e-08,3.18204e-08,3.23569e-08,3.27359e-08,3.23021e-08,3.18636e-08,3.14204e-08,3.10218e-08,3.13794e-08,3.17408e-08,3.21062e-08,3.24755e-08,3.24932e-08,3.20599e-08,3.16219e-08,3.11791e-08,3.07314e-08,3.0279e-08,2.98216e-08,3.02719e-08,3.10021e-08,3.17402e-08,3.24863e-08,3.24121e-08,3.11196e-08,2.9813e-08,3.74596e-08,4.69088e-08,4.27918e-08,3.4908e-08,3.06698e-08,3.04972e-08,3.03229e-08,3.03075e-08,3.12795e-08,3.2262e-08,3.17046e-08,2.99866e-08,3.05823e-08,3.08571e-08,3.01105e-08,2.93559e-08,2.87633e-08,2.90753e-08,2.93908e-08,3.04755e-08,3.30991e-08,3.44261e-08,3.23782e-08,3.0308e-08,2.96304e-08,2.95105e-08,2.93893e-08,2.92668e-08,2.92149e-08,2.98416e-08,3.0475e-08,3.10971e-08,3.06362e-08,3.01703e-08,2.96993e-08,2.92232e-08,2.99858e-08,3.26555e-08,3.53542e-08,3.76124e-08,3.25691e-08,2.88706e-08,2.9049e-08,2.92293e-08,3.42437e-08,6.07688e-08,4.38178e-08,2.96335e-08,2.90891e-08,2.85387e-08,2.79824e-08,2.94687e-08,3.09735e-08,3.03954e-08,2.9811e-08,2.92203e-08,2.86232e-08,2.83474e-08,2.82799e-08,2.82117e-08,2.81428e-08,2.80731e-08,2.80026e-08,2.80374e-08,2.80767e-08,2.81164e-08,2.81565e-08,2.81153e-08,2.80188e-08,2.79213e-08,2.78227e-08,2.8249e-08,3.03801e-08,3.0778e-08,2.89392e-08,2.84739e-08,2.87773e-08,2.87918e-08,2.87537e-08,2.87152e-08,2.86762e-08,2.86368e-08,2.857e-08,2.8395e-08,2.82182e-08,2.80394e-08,2.78586e-08,2.76759e-08,2.76259e-08,2.76067e-08,2.75873e-08,2.75677e-08,2.75479e-08,2.757e-08,2.76505e-08,2.77318e-08,2.7814e-08,2.78971e-08,2.79811e-08,2.8e-08,2.8e-08,2.8e-08,2.8e-08,2.8e-08,2.8e-08,3.77901e-08,6.5133e-08,9.27731e-08,1.20713e-07,1.48957e-07,1.38385e-07,8.58569e-08,3.27579e-08,2.82376e-08,2.80719e-08,2.79044e-08,2.77431e-08,2.76885e-08,2.76333e-08,2.75775e-08,2.75211e-08,2.74641e-08,2.74065e-08,2.73483e-08,2.72894e-08,2.72299e-08,2.71697e-08,2.71089e-08,2.70474e-08,2.69882e-08,2.6938e-08,2.68873e-08,2.6836e-08,2.67841e-08,2.67317e-08,2.66898e-08,2.66552e-08,2.66202e-08,2.65849e-08,2.65491e-08,2.6513e-08,2.64764e-08,2.64395e-08,2.64383e-08,2.67009e-08,2.69664e-08,3.26214e-08,5.11178e-08,3.89635e-08,2.66771e-08,2.62209e-08,2.62361e-08,2.62516e-08,2.62672e-08,2.6283e-08,2.6299e-08,2.63162e-08,2.63345e-08,2.6353e-08,2.63717e-08,2.63906e-08,2.64386e-08,2.66436e-08,2.68508e-08,2.70603e-08,2.72721e-08,2.74862e-08,3.78777e-08,3.35605e-08,2.91452e-08,2.66932e-08,2.68915e-08,2.70918e-08,2.72944e-08,4.03793e-08,3.35309e-08,2.67096e-08,2.66762e-08,2.66424e-08,2.66082e-08,2.65736e-08,2.65387e-08,2.65017e-08,2.64506e-08,2.6399e-08,2.63468e-08,2.62941e-08,2.62407e-08,2.61868e-08,2.61323e-08,2.60772e-08,2.60215e-08,2.60198e-08,2.60522e-08,2.6085e-08,2.61181e-08,2.61515e-08,2.61854e-08,2.62196e-08,2.62542e-08,2.62891e-08,2.63244e-08,2.63602e-08,2.63963e-08,2.64327e-08,2.64696e-08,2.65069e-08,2.64831e-08,2.64582e-08,2.64331e-08,2.64077e-08,2.6382e-08,2.6356e-08,2.63297e-08,2.63032e-08,2.62763e-08,2.62492e-08,2.62218e-08,2.61864e-08,2.61407e-08,2.60946e-08,2.60479e-08,2.60007e-08,2.59531e-08,2.59049e-08,2.58561e-08,2.58069e-08,2.57571e-08,2.57068e-08,2.56559e-08,2.56045e-08,2.55525e-08,2.55247e-08,2.55488e-08,2.55731e-08,2.55977e-08,2.56225e-08,2.56476e-08,2.5673e-08,2.56987e-08,2.57246e-08,2.57508e-08,2.57773e-08,2.58041e-08,2.57827e-08,2.57468e-08,2.57106e-08,2.56739e-08,2.56369e-08,2.55995e-08,2.55616e-08,2.55233e-08,2.54847e-08,2.54456e-08,2.54061e-08,2.53661e-08,2.53257e-08,3.13908e-08,3.78936e-08,3.29834e-08,2.82417e-08,3.63624e-08,3.54721e-08,3.24248e-08,2.93443e-08,2.62304e-08,2.61764e-08,2.62498e-08,2.63239e-08,2.63989e-08,2.64746e-08,4.23009e-08,3.26389e-08,2.99236e-08,3.6232e-08,2.72184e-08,3.70707e-08,3.11182e-08,3.27634e-08,3.69915e-08,2.58401e-08,3.28381e-08,3.65776e-08,2.80819e-08,3.93585e-08,3.39122e-08,2.56111e-08,3.74088e-08,3.03315e-08,2.76866e-08,3.63632e-08,2.73713e-08,2.51874e-08,2.60827e-08,4.01426e-08,4.65975e-08,3.39814e-08,4.98459e-08,2.5517e-08,2.5517e-08,4.404e-08,4.51755e-08,4.28368e-08,3.94498e-08,2.90751e-08,3.63229e-08,3.83479e-08,3.18319e-08,2.53134e-08,2.5519e-08,3.16946e-08,3.15228e-08,2.95932e-08,2.76426e-08,2.66051e-08,3.79717e-08,4.33713e-08,3.6839e-08,2.50493e-08,2.51696e-08,2.52911e-08,2.5414e-08,3.75767e-08,4.26646e-08,4.77686e-08,5.04456e-08,3.05037e-08,6.11069e-08,8.98985e-08,8.61566e-08,5.53312e-08,8.68809e-08,1.25385e-07,9.63216e-08,4.81895e-08,2.88473e-08,3.13832e-08,3.58156e-08,2.80241e-08,6.32986e-08,4.29578e-08,2.65433e-08,3.72224e-08,3.53519e-08,2.93633e-08,2.91165e-08,3.33833e-08,2.6405e-08,3.49644e-08,3.45177e-08,3.40662e-08,3.10798e-08,2.88539e-08,3.42707e-08,3.05005e-08,2.50968e-08,2.82672e-08,3.1472e-08,3.47116e-08,2.70818e-08,3.2282e-08,3.75387e-08,2.92142e-08,4.04298e-08,4.03724e-08,3.95156e-08,3.17997e-08,2.79106e-08,4.05481e-08,2.57064e-08,3.13119e-08,3.69783e-08,3.97444e-08,3.97789e-08,3.98138e-08,3.97994e-08,3.96325e-08,3.94639e-08,3.93504e-08,3.92823e-08,3.92134e-08,3.89499e-08,2.9907e-08,3.12772e-08,3.74614e-08,3.69065e-08,3.49051e-08,3.37543e-08,3.28098e-08,3.22628e-08,3.29457e-08,3.12994e-08,2.65761e-08,2.85656e-08,3.06262e-08,3.09584e-08,4.18145e-08,5.58309e-08,3.96125e-08,3.15546e-08,3.02507e-08,2.99544e-08,2.97711e-08,3.05607e-08,3.13589e-08,3.20018e-08,3.26096e-08,3.32241e-08,3.38914e-08,3.45705e-08,3.52569e-08,3.58128e-08,3.62017e-08,3.65949e-08,3.69923e-08,3.71033e-08,3.72098e-08,3.76423e-08,3.89059e-08,3.79641e-08,3.70121e-08,3.60497e-08,3.33373e-08,3.29106e-08,3.24792e-08,3.20431e-08,3.15836e-08,3.10945e-08,3.06001e-08,3.02356e-08,2.99809e-08,2.97235e-08,2.94632e-08,3.85936e-08,4.90193e-08,5.95584e-08,2.59314e-08,2.41093e-08,2.38947e-08,2.38947e-08,2.38947e-08,2.55127e-08,2.9411e-08,3.33516e-08,3.7335e-08,2.40476e-08,2.43087e-08,2.45726e-08,3.31102e-08,4.27845e-08,2.5545e-08,2.95576e-08,3.11821e-08,5.55276e-08,4.66541e-08,1.27148e-07,7.95248e-08,4.25478e-08,5.05135e-08,3.14408e-08,2.89315e-08,3.84056e-08,2.34119e-08,2.34817e-08,2.51119e-08,2.63241e-08,2.4442e-08,2.29922e-08,2.29597e-08,2.29268e-08,2.28935e-08,2.28599e-08,2.28304e-08,2.28988e-08,2.2968e-08,2.48481e-08,2.82748e-08,2.56258e-08,2.31222e-08,2.26856e-08,2.37596e-08,3.3331e-08,4.20726e-08,2.49566e-08,2.33858e-08,2.40223e-08,2.48031e-08,2.55923e-08,2.48844e-08,2.42863e-08,2.62973e-08,2.45313e-08,2.5397e-08,4.83879e-08,3.18455e-08,2.75539e-08,2.81687e-08,3.37327e-08,2.74083e-08,4.05845e-08,3.10573e-08,2.73504e-08,2.62304e-08,2.48396e-08,2.47178e-08,2.45947e-08,2.57782e-08,2.63133e-08,2.64468e-08,2.53279e-08,2.38548e-08,2.35023e-08,2.33349e-08,2.33002e-08,2.57055e-08,2.27154e-08,2.23251e-08,2.41543e-08,3.16374e-08,0};


	int N = (sizeof(binCenter)/sizeof(*binCenter)); // number of bins of log histogram. 
	int num_samples = time_input*1e8; // time * 1e8 [samples/sec]
	double randomPhase;
	vector <double> waveform;

	for(int i=0;i<N;i++){

		randomPhase = unifRand();

		//the waveform at some given time is the sum of the noise over all the bins
		for(int s=0; s <= num_samples; s++) {
			if( i==0 ) {
				waveform.push_back(sqrt(2*binWidth[i])*binHeight[i]*sin(2*PI*binCenter[i]*s*1e-8+randomPhase));
			}
			else {
				waveform[s] += sqrt(2*binWidth[i])*binHeight[i]*sin(2*PI*binCenter[i]*s*1e-8+randomPhase);
			}
		}

	}   

	return waveform;

}
